<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>macOS screenshot: capture selected window but for dialogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>document.documentElement.classList.add(localStorage.theme || ((matchMedia && matchMedia('(prefers-color-scheme: dark)').matches) ? 'dark' : 'light'))</script>
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/github-20220617.css">
  <link rel="stylesheet" href="/css/main-20230317.css">
  <link rel="icon" href="/favicon.ico" data-emoji="üèïÔ∏è">
  <link rel="alternate" href="/feed.xml" type="application/atom+xml" title="CodeJam">
  <meta property="og:title" content="macOS screenshot: capture selected window but for dialogs">
  <meta property="og:description" content="On macOS, you can take a screenshot of a specific window, by pressing Command + Shfit + 5 and selecting Capture Selected Window as explained here.">
  <meta property="og:image" content="https://www.codejam.info/img/profile.jpg">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@valeriangalliat">
  <meta name="twitter:creator" content="@valeriangalliat">
</head>
<body class="post">
  <nav>
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/val.html">About</a></li>
      <li><a href="/now.html">Now</a></li>
      <li class="pull"><button title="Toggle theme" class="change-color-theme">üåù</button></li>
    </ul>
  </nav>
  <header>
    <div class="header-inner">
      <div class="content">
<h1>macOS screenshot: capture selected window but for dialogs</h1>
<p class="date">April 13, 2023</p>
      </div>
    </div>
  </header>
  <div class="content">
<p>On macOS, you can take a screenshot of a specific window, by pressing
<kbd>Command</kbd> + <kbd>Shfit</kbd> + <kbd>5</kbd> and selecting
<strong>Capture Selected Window</strong> as explained <a href="https://support.apple.com/en-ca/guide/mac-help/mh26782/mac">here</a>.</p>
<p>Alternatively, you can use <kbd>Command</kbd> + <kbd>Shfit</kbd> +
<kbd>4</kbd> to bring the free selection tool, and press
<kbd>Space</kbd> to go in window selection mode.</p>
<p>This is neat, because it captures the window with a nice shadow over a
transparent background, so when embedded, it looks like this:</p>
<figure class="center">
  <img alt="A blank terminal window" srcset="../../img/2023/04/dialog/window.png 2x">
</figure>
<p>This is great, but sometimes you want to select just a <em>dialog</em> inside a
window. For example, if I was to try to close this terminal:</p>
<figure class="center">
  <img alt="A dialog to confirm whether to close all tabs" srcset="../../img/2023/04/dialog/window-dialog.png 2x">
</figure>
<p>Here, the screenshot tool only lets me capture the whole window, but I
can‚Äôt have it capture <em>just</em> the dialog in the middle, and do so with
the nice shadow.</p>
<p>In this case it‚Äôs not too bad because the parent window was small, but
what if you‚Äôre capturing a small dialog inside a very large window?</p>
<p>You can always do a free selection or crop it yourself, but then you
still won‚Äôt have the nice shadow with transparency:</p>
<figure class="center">
  <img alt="Cropped dialog" srcset="../../img/2023/04/dialog/dialog-crop.png 2x">
</figure>
<p>Wouldn‚Äôt it be great if we could have the following instead?</p>
<figure class="center">
  <img alt="Nice dialog with shadow" srcset="../../img/2023/04/dialog/dialog-shadow.png 2x">
</figure>
<h2 id="introducing-windowify" tabindex="-1"><a class="header-anchor" href="#introducing-windowify"><span>Introducing Windowify</span></a></h2>
<p><a href="https://github.com/valeriangalliat/windowify">Windowify</a> is a small
tool that I made to solve this issue. I‚Äôll start with how to use it for
that use case, then I‚Äôll jump in the <a href="#technical-details">technical details</a>.</p>
<p>Once installed, you can give it an image of your choice, and all it does
is display it in a native macOS window, exposing to you the various
styling options that macOS offers.</p>
<p>By default, if we gave it the earlier crop, it would display the following:</p>
<figure class="center">
  <img alt="Dialog with a title bar" srcset="../../img/2023/04/dialog/dialog-title.png 2x">
</figure>
<p>In our case, we need to use <code>windowify --minimal</code>, which is really a
shortcut for <code>windowify -closable -miniaturizable -resizable +fullSizeContentView +titlebarAppearsTransparent +titleHidden</code>. It will
show our image in a window with rounded corners but without any UI
element otherwise (like the title bar and close button).</p>
<p>We can now take a screenshot of this new window, this time using the
native window selection, so we get the shadow and transparency!</p>
<figure class="center">
  <img alt="Nice dialog with shadow" srcset="../../img/2023/04/dialog/dialog-shadow.png 2x">
</figure>
<h2 id="technical-details" tabindex="-1"><a class="header-anchor" href="#technical-details"><span>Technical details</span></a></h2>
<p>To whoever may be interested, I‚Äôll give some technical details on how
this works.</p>
<p>Windowify is a Swift program, and uses it as a dynamic interpreter,
simply by using <code>#!/usr/bin/env swift</code> as a shebang, which I had no clue
was possible prior to this.</p>
<p>While most Swift windowed apps are expected to be created as part of an
Xcode project, it turns out the library <a href="https://stackoverflow.com/questions/30763229/display-window-on-osx-using-swift-without-xcode-or-nib">is flexible enough</a>
to allow easily creating windows without a complex app boilerplate and
an explicit compilation process!</p>
<p>This is made particularly easy using
<a href="https://developer.apple.com/documentation/appkit/nsapplication/1428360-shared"><code>NSApplication.shared</code></a>
which automatically creates the application instance if it doesn‚Äôt
exist.</p>
<p>The script looks at <code>CommandLine.arguments</code> to parse the CLI arguments,
and uses a <code>NSImage</code> and <code>NSImageView</code> to display the image in a
<code>NSWindow</code>.</p>
<p>The main logic is to translate the CLI arguments into the matching
<code>styleMask</code> and other properties of <code>NSWindow</code>, to make the appearance
customizable by the user.</p>
<p>In the first place I had it working without even using a custom
<code>NSApplicationDelegate</code>, but the main application loop was then blocking
the thread and made the menu unresponsive (I use a menu to handle
<kbD>Command</kbd> + <kbd>W</kbd> to close the window). Moving the logic
inside an application delegate resolved that.</p>
<p>Take a look at <a href="https://github.com/valeriangalliat/windowify/blob/main/windowify">the code</a>
if you want to know in more details how this all works!</p>
<section class="post-footer">
  <h3>Want to leave a comment?</h3>
  <p>
    Start a conversation on <a href="https://twitter.com/valeriangalliat">Twitter</a> or send me an <a href="mailto:val@codejam.info">email</a>! üíå<br>
    This post helped you? <a href="https://ko-fi.com/funkyval">Buy me a coffee</a>! üçª
  </p>
</section>
  </div>
  <footer>
    <div class="footer-inner">
      <figure>
        <a href="/val.html">
          <img alt="The author (Val) in front of a mountain" src="/img/profile.jpg">
        </a>
      </figure>
      <div class="footer-content">
        <p>
          Made with üß° by <a href="/val.html">Val</a>.
          Generated from a <abbr title="Pull requests welcome!"><a href="https://github.com/valeriangalliat/blog/tree/master/2023/04/macos-screenshot-dialog.md">public repository</a></abbr>.
        </p>
        <ul class="social">
          <li>
            <a href="https://twitter.com/valeriangalliat">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>Twitter</title>
                <use href="/img/icons/407-twitter.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://github.com/valeriangalliat">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>GitHub</title>
                <use href="/img/icons/433-github.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://www.instagram.com/funkyval_/">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>Instagram</title>
                <use href="/img/icons/403-instagram.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://www.youtube.com/@FunkyVal">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>YouTube</title>
                <use href="/img/icons/414-youtube.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://ko-fi.com/funkyval">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>Buy me a coffee!</title>
                <use href="/img/icons/219-heart.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="/feed.xml">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>RSS</title>
                <use href="/img/icons/412-rss.svg#icon"></use>
              </svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </footer>
  <script src="/js/emojicon.js"></script>
  <script src="/js/main-20230317.js"></script>
</body>
</html>

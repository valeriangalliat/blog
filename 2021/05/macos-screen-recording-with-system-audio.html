<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>macOS screen recording with system audio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/github.css">
  <link rel="stylesheet" href="/css/main-20211017.css">
  <link rel="icon" href="data:," data-emoji="ðŸ•">
  <link rel="alternate" href="/feed.xml" type="application/atom+xml" title="CodeJam">
  <meta property="og:title" content="macOS screen recording with system audio">
  <meta property="og:description" content="This is surprisingly not trivial to do, even though it seems like a key feature when doing a screen recording. It turns out you cannot do that natively on macOS (Iâ€™m currently on Big Sur), and you need an external software to do the magic.">
  <meta property="og:image" content="https://www.codejam.info/img/profile.jpg">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@valeriangalliat">
  <meta name="twitter:creator" content="@valeriangalliat">
</head>
<body class="post">
  <nav>
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/val.html">About</a></li>
      <li><a href="https://photography.codejam.info/">Photography</a></li>
    </ul>
    <ul class="social">
      <li>
        <a href="https://www.youtube.com/FunkyVal">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <title>YouTube</title>
            <use href="/img/icons/414-youtube.svg#icon"></use>
          </svg>
        </a>
      </li>
      <li>
        <a href="https://www.instagram.com/funkyval_/">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <title>Instagram</title>
            <use href="/img/icons/403-instagram.svg#icon"></use>
          </svg>
        </a>
      </li>
      <li>
        <a href="https://twitter.com/valeriangalliat">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <title>Twitter</title>
            <use href="/img/icons/407-twitter.svg#icon"></use>
          </svg>
        </a>
      </li>
      <li>
        <a href="https://github.com/valeriangalliat">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <title>GitHub</title>
            <use href="/img/icons/433-github.svg#icon"></use>
          </svg>
        </a>
      </li>
      <li>
        <a href="https://www.linkedin.com/in/valeriangalliat/">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <title>LinkedIn</title>
            <use href="/img/icons/458-linkedin.svg#icon"></use>
          </svg>
        </a>
      </li>
      <li>
        <a href="/feed.xml">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <title>RSS</title>
            <use href="/img/icons/412-rss.svg#icon"></use>
          </svg>
        </a>
      </li>
    </ul>
  </nav>
  <header>
    <div class="header-inner">
      <div class="content">
<h1>macOS screen recording with system audio</h1>
<p class="date">May 13, 2021</p>
      </div>
    </div>
  </header>
  <div class="content">
<p>This is surprisingly not trivial to do, even though it seems like a key
feature when doing a screen recording. It turns out you cannot do that
natively on macOS (Iâ€™m currently on Big Sur), and you need an external
software to do the magic.</p>
<p>As of today thereâ€™s essentially 3 options: <a href="https://github.com/kyleneideck/BackgroundMusic">Background Music</a>,
<a href="https://github.com/ExistentialAudio/BlackHole">BlackHole</a> and <a href="https://rogueamoeba.com/loopback/">Loopback</a>. The first two are free and open source, and
the last one is proprietary and costs 99 USD before tax.</p>
<p>In this post Iâ€™ll try to go over the 3 of them and tell you the pros and
cons. But first, letâ€™s look at my particular use case.</p>
<h2 id="requirements" tabindex="-1"><a class="header-anchor" href="#requirements"><span>Requirements</span></a></h2>
<p>The task I want to achieve is doing a screen recording (using QuickTime,
through <kbd>Command</kbd> + <kbd>Shift</kbd> + <kbd>5</kbd>) during
which I open Logic Pro, create a new project, and record some music in
it, capturing the audio going live through my system as I play. This is
challenging for a number of reasons:</p>
<ol>
<li>As Iâ€™m gonna be playing music, I donâ€™t want any latency to be
added on top of what I would have when Iâ€™m not recording the system
audio. This is a problem with Background Music but can be worked
around if you only use it to capture the system audio.</li>
<li>BlackHole doesnâ€™t add any latency by design as weâ€™re using it with a
native macOS multi-output device, but Logic Pro resets Core Audio
when it opens, and that used to make it crash, ending the screen
recording unexpectedly. <strong>The good news is that I just tried its
latest version, and itâ€™s not an issue anymore!</strong></li>
<li>Loopback is a great software that can support complex audio routing
setups without adding a lot of overhead, which justifies its price,
but considering that Iâ€™m going to use like 1% of what itâ€™s capable
of, that makes it pretty expensive for my needs.</li>
</ol>
<h2 id="background-music" tabindex="-1"><a class="header-anchor" href="#background-music"><span>Background Music</span></a></h2>
<p><a href="https://github.com/kyleneideck/BackgroundMusic">Background Music</a> is a
macOS audio utility which allows you to manage per-application volume,
auto-pause music when other audio sources are playing, and record system
audio.</p>
<figure class="center">
  <img alt="Background Music interface" src="../../img/2021/05/background-music.png">
</figure>
<p>The way itâ€™s intended to work is that you set your macOS audio output to
Background Musicâ€™s interface, then inside the Background Music app, you
can chose which physical interface you really want to output to, with
their extra layer of functionality in between.</p>
<div style="text-align: center">
<pre><code class="hljs">Audio interface (input) ðŸŽ¸
|
Logic ðŸŽš
|
Background Music ðŸŽ±
|
Audio interface (output) ðŸ”Š
</code></pre>
</div>
<p>Current stable version 0.3.2 doesnâ€™t support Big Sur, but they provide a
0.4.0 snapshot that does. The 0.4.0 version works well on my machine and
I can successfully capture system audio in a screen recording with it.</p>
<p>The issue in my case is that when Iâ€™m playing an instrument, e.g. bass
or guitar plugged into my audio interface, and monitoring its output,
while Logic is set to output audio to Background Musicâ€™s interface (and
Background Music being configured to then output to my speakers),
thereâ€™s a pretty significant delay that makes it impossible to play
live while recording. Bummer.</p>
<h3 id="making-it-low-latency" tabindex="-1"><a class="header-anchor" href="#making-it-low-latency"><span>Making it low latency</span></a></h3>
<p>This can be mitigated by using a multi-output device (in <em>Audio MIDI
Setup</em>, itâ€™s native to macOS Core Audio) to send the audio output
both to my speakers for monitoring, and to Background Music for
recording, in two independent channels, so that Background Music
wouldnâ€™t delay the signal that goes to my speakers.</p>
<div style="text-align: center">
<pre><code class="hljs">Audio interface (input) ðŸŽ¸
|
Logic ðŸŽš
|
Multi-output device ðŸŽ›
|
Audio interface (output) ðŸ”Š | Background Music ðŸŽ±        
</code></pre>
</div>
<p>This would then be exactly the same thing that weâ€™re doing with
<a href="#blackhole">BlackHole</a> below, except that we have an extra layer of
Background Music functionality that is there but weâ€™re not using
(because weâ€™re never actually listening to what Background Music
outputs, except in the screen recording).</p>
<p>But Background Music requires you to configure an output, it cannot be
the last node in the pipeline, so to work around this, I configured it
to output to the headphones jack of my machine (which is not plugged),
or I can configure it to output to my screen speakers and then mute it
form the screen controls itself.</p>
<p>So in reality it needs to be like this:</p>
<div style="text-align: center">
<pre><code class="hljs">Audio interface (input) ðŸŽ¸
|
Logic ðŸŽš
|
Multi-output device ðŸŽ›
|
Audio interface (output) ðŸ”Š | Background Music ðŸŽ±        
                    |
                      Headphones (unplugged) ðŸ”‡
</code></pre>
</div>
<p>This way Background Music still thinks itâ€™s outputting somewhere (which
it really wants to) and I can use it to capture the system sounds, and
get a low latency monitoring output directly sent to my speakers without
going through Background Music.</p>
<h2 id="blackhole" tabindex="-1"><a class="header-anchor" href="#blackhole"><span>BlackHole</span></a></h2>
<p><a href="https://github.com/ExistentialAudio/BlackHole">BlackHole</a> is open
source, and is sponsored by Existential Audio, which means that their
main download link requires you to subscribe (for free) on Existential
Audioâ€™s website to get access to the download.</p>
<p>They do have Homebrew formulas as well (<code>brew install blackhole-2ch</code> or
<code>brew install blackhole-16ch</code> depending if you want 2 or 16 channels),
and if you donâ€™t want to use Homebrew, you can just grab the direct
download link from the formula code itself (<a href="https://github.com/Homebrew/homebrew-cask/blob/master/Casks/blackhole-2ch.rb">2 channels</a> and <a href="https://github.com/Homebrew/homebrew-cask/blob/master/Casks/blackhole-16ch.rb">16 channels</a>).</p>
<p>Then for my use case, I create a multi-output device in <em>Audio MIDI
Setup</em> that goes both to my speakers for monitoring, and to BlackHole
for recording.</p>
<figure class="center">
  <img alt="BlackHole interface" src="../../img/2021/05/blackhole.png">
</figure>
<p>This gives us a layout like this:</p>
<div style="text-align: center">
<pre><code class="hljs">Audio interface (input) ðŸŽ¸
|
Logic ðŸŽš
|
Multi-output device ðŸŽ›
|
Audio interface (output) ðŸ”Š | BlackHole ðŸŒŒ               
</code></pre>
</div>
<p>I can then set the screen recording audio capture to BlackHole and it
just works, and is as low latency as can be because BlackHole is not in
the way of my audio interface output!</p>
<p>As I mentioned earlier, BlackHole used to occasionally crash when I
opened Logic during a screen recording, because Logic resets Core Audio
on start or when opening a new project, but this was many months ago
and I just tried again with the latest version and the issue doesnâ€™t
happen anymore, so that will be my go-to from now on!</p>
<h2 id="loopback" tabindex="-1"><a class="header-anchor" href="#loopback"><span>Loopback</span></a></h2>
<p>Finally, <a href="https://rogueamoeba.com/loopback/">Loopback</a> is made by Rogue
Amoeba and costs 99 USD. Itâ€™s got a very neat UI and is a vary capable
software, that can deal with complex audio input and output routing
setups, but itâ€™s coming at a pretty high price point for what I
would do with it.</p>
<figure class="center">
  <img alt="Loopback interface" src="../../img/2021/05/loopback.png">
</figure>
<p>You can set it up like Background Music, where you route your Logic
output to Loopback, then inside Loopback add a monitor node that
goes to your physical output interface. This is fairly low latency, at
least less noticeable than Background Music, but unless you need a
complex audio routing setup, why even add <em>any</em> latency?</p>
<p>Instead, itâ€™s even better for what Iâ€™m doing to setup one more time a
multi-output device in <em>Audio MIDI Setup</em> to have a direct
output to my speakers as well as an independent output to Loopback for
screen recording purpose, the same way we did with BlackHole.</p>
<p>But that that point 99 USD is a very high price for what weâ€™re doing
with it.</p>
<h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion"><span>Conclusion</span></a></h2>
<p>Background Music, BlackHole and Loopback are all great software, and
while theyâ€™re all capable of capturing the system audio onto a screen
recording, theyâ€™re all built with different use cases in mind and they
each have their own approach to solving that problem.</p>
<p>Background Music seems to be designed to be your main audio output,
adding an extra layer of functionality in front of your speakers (but
also an extra layer of latency). You can work around that with a
multi-output device and sending Background Music to a muted or unplugged
output, but while that works, it feels quite hacky.</p>
<p>BlackHole is meant to be used as a transparent interface to route audio
from one software to another, in a totally agnostic way. It does one
thing, and does it well, delegating the heavy lifting of splitting the
audio signal to macOS native multi-output device, which keeps things
fast and simple.</p>
<p>Finally, Loopback is the Swiss Army knife of audio routing. While you
can use it as your main audio output, you donâ€™t need to and itâ€™ll
happily act like BlackHole. You can dynamically add as many virtual
Loopback interfaces as you want (which is also possible with BlackHole
but requires recompiling the driver), and in each virtual interface,
layout your inputs, outputs and monitors in pretty much any possible
way. This comes to the cost of 99 USD though, so unless you really need
a tool this powerful, you might be better off using BlackHole.</p>
<p>As far as Iâ€™m concerned, for my very basic use case, BlackHole does a
perfect job. Itâ€™s a low level tool without any bells and whistles, and
thatâ€™s precisely what makes it lightweight and fast, adding virtually no
latency when capturing the system audio while monitoring a live
input.</p>
<p>I hope this comparison was useful to you, and that you found the tool
that suits you best!</p>
<p>Also, not so long ago I wrote an article on <a href="../../2020/12/macos-quicktime-screen-recording-48-khz-sample-rate.html">how to capture screen recording audio at 48 kHz</a>
instead of 44.1 kHz, so you might find that interesting as well if you
want to keep the sample rate consistent in your production pipeline.</p>
<section class="post-footer">
  <h3>Want to leave a comment?</h3>
  <p>Start a conversation on <a href="https://twitter.com/valeriangalliat">Twitter</a> or send me an <a href="mailto:val@codejam.info">email</a>! ðŸ’Œ
</section>
  </div>
  <footer>
    <p>
      Made with ðŸ§¡ by <a href="/val.html">Val</a> in Montreal.<br>
      Generated from a <a href="https://github.com/valeriangalliat/blog/tree/master/2021/05/macos-screen-recording-with-system-audio.md">public repository</a>. Feel free to <a href="/val.html#contact">contact me</a>, I'd love to hear your thoughts!
    </p>
  </footer>
  <script src="/js/emojicon.js"></script>
  <script src="/js/main-20210719.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Make floats and lists collaborate üôà</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>document.documentElement.classList.add((matchMedia && matchMedia('(prefers-color-scheme: dark)').matches || localStorage.dark) ? 'dark' : 'light')</script>
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/github-20220617.css">
  <link rel="stylesheet" href="/css/main-20220617.css">
  <link rel="icon" href="/favicon.ico" data-emoji="üèïÔ∏è">
  <link rel="alternate" href="/feed.xml" type="application/atom+xml" title="CodeJam">
  <meta property="og:title" content="Make floats and lists collaborate üôà">
  <meta property="og:description" content="Am I the only one struggling to get lists and other styled elements to render properly next to a float?">
  <meta property="og:image" content="https://www.codejam.info/img/profile.jpg">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@valeriangalliat">
  <meta name="twitter:creator" content="@valeriangalliat">
</head>
<body class="post">
  <nav>
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/val.html">About</a></li>
    </ul>
    <ul>
      <li><button title="Toggle theme" class="change-color-theme">üåù</button></li>
    </ul>
  </nav>
  <header>
    <div class="header-inner">
      <div class="content">
<h1>Make floats and lists collaborate üôà</h1>
<p class="date">April 11, 2022</p>
      </div>
    </div>
  </header>
  <div class="content">
<p>Am I the only one struggling to get lists and other styled elements to
render properly next to a float?</p>
<p>At least, it definitely doesn‚Äôt work well out of the box. Let‚Äôs start
from a generic browser style sheet context (a HTML file without any CSS
added), or <a href="https://necolas.github.io/normalize.css/">Normalize.css</a>.</p>
<h2 id="the-problem" tabindex="-1"><a class="header-anchor" href="#the-problem"><span>The problem</span></a></h2>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;square&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-css"><span class="hljs-selector-class">.square</span> {
    <span class="hljs-attribute">float</span>: left;
    <span class="hljs-attribute">width</span>: <span class="hljs-number">6em</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">6em</span>;
    <span class="hljs-attribute">background</span>: <span class="hljs-number">0366</span>d6;
}
</code></pre>
<iframe src="/img/2022/04/float-demo/example-0.html" width="100%"></iframe>
<p>This is not great. The left padding of the <code>&lt;ul&gt;</code> overlaps with the
square, and so does the bullet point.</p>
<p>The only way I‚Äôm aware of to fix this in a normal document flow (e.g.
not doing a very custom thing with Flexbox or grids) is to set
<code>overflow: hidden</code> to the <code>&lt;ul&gt;</code> (or on a parent block that‚Äôs also being
pushed by the float):</p>
<pre><code class="hljs language-css"><span class="hljs-selector-tag">ul</span> {
    <span class="hljs-attribute">overflow</span>: hidden;
}
</code></pre>
<iframe src="/img/2022/04/float-demo/example-1.html" width="100%"></iframe>
<p>Better. Let‚Äôs add a paragraph <em>before</em> the square and <em>after</em> the <code>&lt;ul&gt;</code>
and see what happens.</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;square&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
</code></pre>
<iframe src="/img/2022/04/float-demo/example-2.html" width="100%"></iframe>
<p>So far so good.</p>
<h2 id="breaking-it-again" tabindex="-1"><a class="header-anchor" href="#breaking-it-again"><span>Breaking it again</span></a></h2>
<p>Now let‚Äôs assume we have paragraphs <em>inside</em> our list items (yes, this
happens). You also get a similar problem with <code>&lt;blockquote&gt;</code>s or any
other element where you might want to have a left border and padding,
and that contains paragraphs or anything with a vertical margin.</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;square&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hello from a paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
</code></pre>
<iframe src="/img/2022/04/float-demo/example-3.html" width="100%"></iframe>
<p>Subtle yet important thing to notice: the vertical margin from the
list paragraph now don‚Äôt merge with the adjacent margins because of our
<code>overflow: hidden</code> hack! So we have double the margin before and after
the list. Not good.</p>
<p>But what is this behavior in the first place? Meet <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Box_Model/Mastering_margin_collapsing">margin collapsing</a>.
This concept is is very well defined by <a href="https://css-tricks.com/what-you-should-know-about-collapsing-margins/">CSS-Tricks</a>:</p>
<blockquote>
<p>Collapsing margins happen when two vertical margins come in contact
with one another. If one margin is greater than the other, then that
margin overrides the other, leaving one margin.</p>
</blockquote>
<p>So by using <code>overflow: hidden</code>, we break margin collapsing.</p>
<h2 id="avoiding-collapsing-altogether" tabindex="-1"><a class="header-anchor" href="#avoiding-collapsing-altogether"><span>Avoiding collapsing altogether</span></a></h2>
<p>It‚Äôs quite common to use something like <code>margin-top: 0</code> and
<code>margin-bottom: 1em</code> on all content elements (or the other way
around) to avoid relying on (and dealing with) margin collapsing.</p>
<p><a href="https://twitter.com/valeriangalliat/status/1512869222111756292">I ran a poll on Twitter</a>
that got 74 answers. A majority of y‚Äôall use this technique to avoid
margin collapsing!</p>
<table>
  <tr>
    <td><code>p { margin: 1em 0; }</code>
    <td>37.8%</td>
  </tr>
  <tr>
    <td><code>p { margin-bottom: 1em; }</code>
    <td>62.2%</td>
  </tr>
</table>
<p>We can try this and see if it helps with our problem.</p>
<pre><code class="hljs language-css"><span class="hljs-selector-tag">p</span>, <span class="hljs-selector-tag">ul</span> {
    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">0</span>;
}
</code></pre>
<iframe src="/img/2022/04/float-demo/example-4.html" width="100%"></iframe>
<p>It‚Äôs better. We don‚Äôt have double the spacing anymore above the <code>&lt;ul&gt;</code>,
but we still have the problem with the <code>margin-bottom</code> of the <code>&lt;ul&gt;</code> not
collapsing with its inner paragraph.</p>
<p>What we can do though is to set <code>overflow: hidden</code> on a wrapper element
instead of the <code>&lt;ul&gt;</code> directly, then this should let the inner paragraph
collapse with it‚Äôs parent <code>&lt;ul&gt;</code>'s <code>margin-bottom</code>:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;square&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;float-hack&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hello from a paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-css"><span class="hljs-selector-class">.float-hack</span> {
    <span class="hljs-attribute">overflow</span>: hidden;
}
</code></pre>
<iframe src="/img/2022/04/float-demo/example-5.html" width="100%"></iframe>
<p>Sweet, that works like a charm!</p>
<p>That being said, it works especially well because we decided to kill the
<code>margin-top</code> of content elements, but if you want to remove the
<code>margin-bottom</code> instead and keep the <code>margin-top</code>, it‚Äôs a different
story:</p>
<pre><code class="hljs language-css"><span class="hljs-selector-tag">p</span>, <span class="hljs-selector-tag">ul</span> {
    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">0</span>;
}
</code></pre>
<iframe src="/img/2022/04/float-demo/example-6.html" width="100%"></iframe>
<p>So keep that in mind of you want to drop margin collapsing, the margin
you kill has an importance!</p>
<h2 id="a-solution-to-keep-collapsing" tabindex="-1"><a class="header-anchor" href="#a-solution-to-keep-collapsing"><span>A solution to keep collapsing?</span></a></h2>
<p>The simplicity of the previous solution pretty much convinced me to use
this pattern on my blog. But for some reason you might want to keep
relying on margin collapsing and still need to fix this spacing issues
with floats. Let‚Äôs find a way.</p>
<p>Since we need to combat the fact that <code>overflow: hidden</code> prevents our
vertical margins from collapsing, an option is to set <code>margin-top: 0</code>
<strong>recursively</strong> on all the first children of the <code>overflow: hidden</code> element,
and <code>margin-bottom: 0</code> on all the last children.</p>
<p>Why <em>recursively</em>? Because any element in the tree of direct first
children could set a <code>margin-top</code> that we want to cancel (and similarly
for <code>margin-bottom</code> and the last children tree).</p>
<p>But <a href="https://stackoverflow.com/questions/12477272/select-recursive-last-child-possible">we can‚Äôt recursively target all the first or last children of an element</a>!</p>
<p>So a solution would be to write something like this (relying on the
<code>float-hack</code> class we introduced earlier:</p>
<pre><code class="hljs language-css"><span class="hljs-selector-class">.float-hack</span> {
    <span class="hljs-attribute">overflow</span>: hidden;
}

<span class="hljs-selector-class">.float-hack</span> &gt; <span class="hljs-selector-pseudo">:first</span>-child,
<span class="hljs-selector-class">.float-hack</span> &gt; <span class="hljs-selector-pseudo">:first</span>-child &gt; <span class="hljs-selector-pseudo">:first</span>-child,
<span class="hljs-selector-class">.float-hack</span> &gt; <span class="hljs-selector-pseudo">:first</span>-child &gt; <span class="hljs-selector-pseudo">:first</span>-child &gt; <span class="hljs-selector-pseudo">:first</span>-child,
<span class="hljs-selector-class">.float-hack</span> &gt; <span class="hljs-selector-pseudo">:first</span>-child &gt; <span class="hljs-selector-pseudo">:first</span>-child &gt; <span class="hljs-selector-pseudo">:first</span>-child &gt; <span class="hljs-selector-pseudo">:first</span>-child,
<span class="hljs-selector-class">.float-hack</span> &gt; <span class="hljs-selector-pseudo">:first</span>-child &gt; <span class="hljs-selector-pseudo">:first</span>-child &gt; <span class="hljs-selector-pseudo">:first</span>-child &gt; <span class="hljs-selector-pseudo">:first</span>-child &gt; <span class="hljs-selector-pseudo">:first</span>-child {
    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">0</span>;
}

<span class="hljs-selector-class">.float-hack</span> &gt; <span class="hljs-selector-pseudo">:last-child</span>,
<span class="hljs-selector-class">.float-hack</span> &gt; <span class="hljs-selector-pseudo">:last-child</span> &gt; <span class="hljs-selector-pseudo">:last-child</span>,
<span class="hljs-selector-class">.float-hack</span> &gt; <span class="hljs-selector-pseudo">:last-child</span> &gt; <span class="hljs-selector-pseudo">:last-child</span> &gt; <span class="hljs-selector-pseudo">:last-child</span>,
<span class="hljs-selector-class">.float-hack</span> &gt; <span class="hljs-selector-pseudo">:last-child</span> &gt; <span class="hljs-selector-pseudo">:last-child</span> &gt; <span class="hljs-selector-pseudo">:last-child</span> &gt; <span class="hljs-selector-pseudo">:last-child</span>,
<span class="hljs-selector-class">.float-hack</span> &gt; <span class="hljs-selector-pseudo">:last-child</span> &gt; <span class="hljs-selector-pseudo">:last-child</span> &gt; <span class="hljs-selector-pseudo">:last-child</span> &gt; <span class="hljs-selector-pseudo">:last-child</span> &gt; <span class="hljs-selector-pseudo">:last-child</span> {
    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">0</span>;
}
</code></pre>
<p>This should be good enough for most simple cases. You can even have a
paragraph inside a <code>&lt;blockquote&gt;</code>, itself inside a list item!</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;float-hack&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">blockquote</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This is a quote<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">blockquote</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>Or a nested list, which reach the same level of nesting:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;float-hack&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Nested list item<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>Maybe don‚Äôt add a <code>&lt;blockquote&gt;</code> with paragraphs inside this nested list
item or you might want to add a few recursion levels to our earlier CSS
rule. üòÇ</p>
<div class="note">
<p><strong>Note:</strong> this isn‚Äôt a complete fix as it won‚Äôt behave properly if the
collapsing margins are not equal.</p>
<p>The engine normally keeps the greater margin, but here we‚Äôll always nuke
the margin of the first and last items of our <code>float-hack</code> element.</p>
</div>
<h2 id="wrapping-up" tabindex="-1"><a class="header-anchor" href="#wrapping-up"><span>Wrapping up</span></a></h2>
<p>And there you go! Two solutions for the price of one:</p>
<ol>
<li>Prevent margin collapsing altogether by only applying a
<code>margin-bottom</code> and setting <code>margin-top: 0</code> on all content elements.</li>
<li>Recursively target the first and last children of the <code>overflow: hidden</code>
element to cancel their margin.</li>
</ol>
<p>Which one is your favorite?</p>
<section class="post-footer">
  <h3>Want to leave a comment?</h3>
  <p>
    Join the discussion on <a href="https://twitter.com/valeriangalliat/status/1513692138776801287">Twitter</a> or send me an <a href="mailto:val@codejam.info">email</a>! üíå<br>
    This post helped you? <a href="https://ko-fi.com/funkyval">Buy me a coffee</a>! üçª
  </p>
</section>
  </div>
  <footer>
    <figure>
      <a href="/val.html">
        <img alt="The author (Val) looking at a beer glass shining in the beautiful sun" src="/img/profile.jpg">
      </a>
    </figure>
    <div class="footer-content">
      <p>
        Made with üß° by <a href="/val.html">Val</a>.
        Generated from a <abbr title="Pull requests welcome!"><a href="https://github.com/valeriangalliat/blog/tree/master/2022/04/make-floats-and-lists-collaborate.md">public repository</a></abbr>.
      </p>
      <ul class="social">
        <li>
          <a href="https://twitter.com/valeriangalliat">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <title>Twitter</title>
              <use href="/img/icons/407-twitter.svg#icon"></use>
            </svg>
          </a>
        </li>
        <li>
          <a href="https://github.com/valeriangalliat">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <title>GitHub</title>
              <use href="/img/icons/433-github.svg#icon"></use>
            </svg>
          </a>
        </li>
        <li>
          <a href="https://www.instagram.com/funkyval_/">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <title>Instagram</title>
              <use href="/img/icons/403-instagram.svg#icon"></use>
            </svg>
          </a>
        </li>
        <li>
          <a href="https://www.youtube.com/FunkyVal">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <title>YouTube</title>
              <use href="/img/icons/414-youtube.svg#icon"></use>
            </svg>
          </a>
        </li>
        <li>
          <a href="https://ko-fi.com/funkyval">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <title>Buy me a coffee!</title>
              <use href="/img/icons/219-heart.svg#icon"></use>
            </svg>
          </a>
        </li>
        <li>
          <a href="/feed.xml">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <title>RSS</title>
              <use href="/img/icons/412-rss.svg#icon"></use>
            </svg>
          </a>
        </li>
      </ul>
    </div>
  </footer>
  <script src="/js/emojicon.js"></script>
  <script src="/js/main-20220617.js"></script>
</body>
</html>

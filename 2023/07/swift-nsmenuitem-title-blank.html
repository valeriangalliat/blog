<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Swift: NSMenuItem title not showing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>document.documentElement.classList.add(localStorage.theme || ((matchMedia && matchMedia('(prefers-color-scheme: dark)').matches) ? 'dark' : 'light'))</script>
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/github-20220617.css">
  <link rel="stylesheet" href="/css/main-20230317.css">
  <link rel="icon" href="/favicon.ico" data-emoji="üèïÔ∏è">
  <link rel="alternate" href="/feed.xml" type="application/atom+xml" title="CodeJam">
  <meta property="og:title" content="Swift: NSMenuItem title not showing">
  <meta property="og:description" content="If for some reason you‚Äôre making a Swift app and want to programmatically define your menu items, as opposed to using Xcode‚Äôs storyboards to create them visually, you may run into an issue where your menu title is not showing.">
  <meta property="og:image" content="https://www.codejam.info/img/profile.jpg">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@valeriangalliat">
  <meta name="twitter:creator" content="@valeriangalliat">
</head>
<body class="post">
  <nav>
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/val.html">About</a></li>
      <li><a href="https://photography.codejam.info/">Photography</a></li>
      <li class="pull"><button title="Toggle theme" class="change-color-theme">üåù</button></li>
    </ul>
  </nav>
  <header>
    <div class="header-inner">
      <div class="content">
<h1>Swift: <code>NSMenuItem</code> title not showing</h1>
<p class="date">July 27, 2023</p>
      </div>
    </div>
  </header>
  <div class="content">
<p>If for some reason you‚Äôre making a Swift app and want to
programmatically define your menu items, as opposed to using Xcode‚Äôs
storyboards to create them visually, you may run into an issue where
your menu title is not showing.</p>
<p>Let‚Äôs consider the following example (e.g. put it in <code>test.swift</code> and
run it with <code>swift test.swift</code>):</p>
<pre><code class="hljs language-swift"><span class="hljs-keyword">import</span> Cocoa

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AppDelegate</span>: <span class="hljs-title class_ inherited__">NSObject</span>, <span class="hljs-title class_ inherited__">NSApplicationDelegate</span> {
  <span class="hljs-keyword">func</span> <span class="hljs-title function_">applicationDidFinishLaunching</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">notification</span>: <span class="hljs-type">Notification</span>) {
    <span class="hljs-keyword">let</span> app <span class="hljs-operator">=</span> <span class="hljs-type">NSApplication</span>.shared
    app.activate(ignoringOtherApps: <span class="hljs-literal">true</span>)

    <span class="hljs-keyword">let</span> mainMenu <span class="hljs-operator">=</span> <span class="hljs-type">NSMenu</span>()
    app.mainMenu <span class="hljs-operator">=</span> mainMenu

    <span class="hljs-keyword">let</span> appMenu <span class="hljs-operator">=</span> <span class="hljs-type">NSMenuItem</span>()
    mainMenu.addItem(appMenu)

    <span class="hljs-keyword">let</span> editMenu <span class="hljs-operator">=</span> <span class="hljs-type">NSMenuItem</span>(title: <span class="hljs-string">&quot;Edit&quot;</span>, action: <span class="hljs-literal">nil</span>, keyEquivalent: <span class="hljs-string">&quot;&quot;</span>)
    mainMenu.addItem(editMenu)

    <span class="hljs-keyword">let</span> editSubmenu <span class="hljs-operator">=</span> <span class="hljs-type">NSMenu</span>()

    editSubmenu.addItem(withTitle: <span class="hljs-string">&quot;Test&quot;</span>, action: <span class="hljs-literal">nil</span>, keyEquivalent: <span class="hljs-string">&quot;&quot;</span>)
    editMenu.submenu <span class="hljs-operator">=</span> editSubmenu
  }
}

<span class="hljs-keyword">let</span> app <span class="hljs-operator">=</span> <span class="hljs-type">NSApplication</span>.shared
<span class="hljs-keyword">let</span> delegate <span class="hljs-operator">=</span> <span class="hljs-type">AppDelegate</span>()

app.setActivationPolicy(.regular)
app.delegate <span class="hljs-operator">=</span> delegate
app.run()
</code></pre>
<p>When we run it, the edit menu doesn‚Äôt show. Or actually, it‚Äôs there but
its text is blank!</p>
<figure class="center">
  <img alt="Blank edit menu" srcset="../../img/2023/07/swift-edit-blank.png 2x">
</figure>
<p><strong>This is because the <code>NSMenuItem</code> title actually doesn‚Äôt matter here.</strong>
It‚Äôs the title of the <code>NSMenu</code> that we use as a submenu that matters.</p>
<p>Let‚Äôs fix it up:</p>
<pre><code class="hljs language-diff:swift"><span class="hljs-deletion">-<span class="hljs-keyword">let</span> editMenu <span class="hljs-operator">=</span> <span class="hljs-type">NSMenuItem</span>(title: <span class="hljs-string">&quot;Edit&quot;</span>, action: <span class="hljs-literal">nil</span>, keyEquivalent: <span class="hljs-string">&quot;&quot;</span>)</span>
<span class="hljs-addition">+<span class="hljs-keyword">let</span> editMenu <span class="hljs-operator">=</span> <span class="hljs-type">NSMenuItem</span>(title: <span class="hljs-string">&quot;Doesn&#x27;t matter&quot;</span>, action: <span class="hljs-literal">nil</span>, keyEquivalent: <span class="hljs-string">&quot;&quot;</span>)</span>
 mainMenu.addItem(editMenu)

<span class="hljs-deletion">-<span class="hljs-keyword">let</span> editSubmenu <span class="hljs-operator">=</span> <span class="hljs-type">NSMenu</span>()</span>
<span class="hljs-addition">+<span class="hljs-keyword">let</span> editSubmenu <span class="hljs-operator">=</span> <span class="hljs-type">NSMenu</span>(title: <span class="hljs-string">&quot;Edit&quot;</span>)</span>
</code></pre>
<p>And now our title shows up properly!</p>
<figure class="center">
  <img alt="Good edit menu" srcset="../../img/2023/07/swift-edit-good.png 2x">
</figure>
<h2 id="a-note-about-the-app-menu" tabindex="-1"><a class="header-anchor" href="#a-note-about-the-app-menu"><span>A note about the app menu</span></a></h2>
<p>In the example above, note that it was also important to explicitly add
an app menu before our edit menu:</p>
<pre><code class="hljs language-swift"><span class="hljs-keyword">let</span> appMenu <span class="hljs-operator">=</span> <span class="hljs-type">NSMenuItem</span>()
mainMenu.addItem(appMenu)
</code></pre>
<p>This is important, because the first item of the main menu is gonna be
treated as the app menu. If we didn‚Äôt do that, our edit menu would
actually become the app menu, so that <strong>Test</strong> would appear under
<strong>swift-frontend</strong>, and <strong>Edit</strong> would be nowhere to be seen.</p>
<section class="post-footer">
  <h3>Want to leave a comment?</h3>
  <p>
    Start a conversation on <a href="https://twitter.com/valeriangalliat">Twitter</a> or send me an <a href="mailto:val@codejam.info">email</a>! üíå<br>
    This post helped you? <a href="https://ko-fi.com/funkyval">Buy me a coffee</a>! üçª
  </p>
</section>
  </div>
  <footer>
    <div class="footer-inner">
      <figure>
        <a href="/val.html">
          <img alt="The author (Val) in front of a mountain" src="/img/profile.jpg">
        </a>
      </figure>
      <div class="footer-content">
        <p>
          Made with üß° by <a href="/val.html">Val</a>.
          Generated from a <abbr title="Pull requests welcome!"><a href="https://github.com/valeriangalliat/blog/tree/master/2023/07/swift-nsmenuitem-title-blank.md">public repository</a></abbr>.
        </p>
        <ul class="social">
          <li>
            <a href="https://twitter.com/valeriangalliat">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>Twitter</title>
                <use href="/img/icons/407-twitter.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://github.com/valeriangalliat">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>GitHub</title>
                <use href="/img/icons/433-github.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://www.instagram.com/funkyval_/">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>Instagram</title>
                <use href="/img/icons/403-instagram.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://www.youtube.com/@FunkyVal">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>YouTube</title>
                <use href="/img/icons/414-youtube.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://ko-fi.com/funkyval">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>Buy me a coffee!</title>
                <use href="/img/icons/219-heart.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="/feed.xml">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>RSS</title>
                <use href="/img/icons/412-rss.svg#icon"></use>
              </svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </footer>
  <script src="/js/emojicon.js"></script>
  <script src="/js/main-20230317.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Adding search capability to a static blog using the GitHub API</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>document.documentElement.classList.add(localStorage.theme || ((matchMedia && matchMedia('(prefers-color-scheme: dark)').matches) ? 'dark' : 'light'))</script>
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/github-20220617.css">
  <link rel="stylesheet" href="/css/main-20230317.css">
  <link rel="icon" href="/favicon.ico" data-emoji="üèïÔ∏è">
  <link rel="alternate" href="/feed.xml" type="application/atom+xml" title="CodeJam">
  <meta property="og:title" content="Adding search capability to a static blog using the GitHub API">
  <meta property="og:description" content="I just added a search feature to the home page, check it out!">
  <meta property="og:image" content="https://www.codejam.info/img/profile.jpg">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@valeriangalliat">
  <meta name="twitter:creator" content="@valeriangalliat">
</head>
<body class="post">
  <nav>
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/val.html">About</a></li>
      <li><a href="https://photography.codejam.info/">Photography</a></li>
      <li class="pull"><button title="Toggle theme" class="change-color-theme">üåù</button></li>
    </ul>
  </nav>
  <header>
    <div class="header-inner">
      <div class="content">
<h1>Adding search capability to a static blog using the GitHub API</h1>
<p class="date">July 20, 2021</p>
      </div>
    </div>
  </header>
  <div class="content">
<p>I just added a <a href="/index.html#search">search</a> feature to the home page,
check it out!</p>
<p>Actually, it should even work here too.</p>
<blockquote>
  <form class="search" onsubmit="return onSearchSubmit(this)">
    <p>Looking for something? Search the blog!</p>
    <p>
      <input type="text" name="query" placeholder="üîé">
      <button type="submit">Submit</button>
    </p>
    <div class="links posts"></div>
    <div class="message"></div>
  </form>
</blockquote>
<p>This blog is fully static, written in Markdown, the source is <a href="https://github.com/valeriangalliat/blog">hosted on GitHub</a>,
and the live site is hosted on some static site server. Depending on my
current mood, it can be <a href="https://pages.github.com/">GitHub Pages</a>,
nginx, <a href="https://www.netlify.com/">Netlify</a>,
<a href="https://vercel.com/">Vercel</a>, <a href="https://render.com/">Render</a>, or maybe
CloudFlare or S3 in the future, who knows.</p>
<p>Regardless of the hosting service, because of the static nature of the
blog, I can‚Äôt just run <code>grep</code> or similar on the server side to find
matching pages and return results.</p>
<p>Since the blog source is hosted on GitHub as a public repository, the
GitHub API was the obvious, most simple solution.</p>
<p>You can see the full source code <a href="https://github.com/valeriangalliat/blog/blob/01ded0c8defe399526032030bf17b912be6b6319/js/main.js#L163">here</a>,
but in this blog post, I‚Äôll break it down for you.</p>
<h2 id="the-html-part" tabindex="-1"><a class="header-anchor" href="#the-html-part"><span>The HTML part</span></a></h2>
<p>I don‚Äôt use any framework on this blog, it‚Äôs vanilla everything.</p>
<p>For the search form, I just added this snippet.</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;search&quot;</span> <span class="hljs-attr">onsubmit</span>=<span class="hljs-string">&quot;return onSearchSubmit(this)&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Looking for something? Search the blog!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;query&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;üîé&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;links posts&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;message&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre>
<p>By doing <code>onsubmit=&quot;return onSearchSubmit(this)&quot;</code>, I define the action
inline from the markup. Passing <code>this</code> allows me to forward the current
<code>&lt;form&gt;</code> element that‚Äôs being submitted for context, and the <code>return</code>
allows to propagate a <code>return false</code> from the function to cancel the
default behavior of submitting a query.</p>
<p>This is actually the oldest way of scripting events, and the browser
support of this pattern is going to be way better than that of the
<code>async</code> functions in my JS. üòÇ</p>
<p>This kind of code is <a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#inline_event_handlers_%E2%80%94_dont_use_these">often perceived as a bad practice</a>,
outdated, ‚Äúsmelly code‚Äù, ‚Äúnot clean‚Äù and so on by purists (including myself),
because it usually results in poor maintainability, and it would be
better to do something like:</p>
<pre><code class="hljs language-js"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;form.search&#x27;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">form</span> =&gt;</span> {
  form.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;submit&#x27;</span>, onSearchSubmit)
})
</code></pre>
<p>On the other hand, this form is only going to be used on two pages on
the blog (the home page and this very post), so I can afford the
copy/paste maintenance tradeoff, and by tying the handler to the HTML, I
don‚Äôt need my JS to look for <code>form.search</code> elements on every page load
where most of the time there will be none. While <em>this is as much of a
performance issue as the inline event handler is a maintenance
nightmare</em>, I‚Äôll favour this solution, just because.</p>
<p>Also, most modern front-end frameworks define event handlers
<a href="https://developer.mozilla.org/en-US/docs/Learn/Tools_and_testing/Client-side_JavaScript_frameworks/React_interactivity_events_state#handling_form_submission">in ways that are very close</a>
to the HTML <code>onsubmit</code> attribute, and I do like this way of doing
things, so I‚Äôll just apply that to vanilla HTML, even if that means
using an ‚Äúoutdated‚Äù pattern.</p>
<p>That being said, for anything bigger than this use case, it‚Äôll probably
make more sense to use proper JS event handlers, or an actual framework.
Consider yourself warned!</p>
<h2 id="the-js-part" tabindex="-1"><a class="header-anchor" href="#the-js-part"><span>The JS part</span></a></h2>
<p>Before going to the main JS code, I‚Äôll introduce the helpers that it
uses (don‚Äôt worry, there‚Äôs only two!).</p>
<p>The first one is called <code>el</code> and just adds some sugar around
<code>document.createElement</code>, setting attributes and adding child nodes to
it. I find it extremely convenient when scripting sites using vanilla JS.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">el</span> (<span class="hljs-params">name, attrs = {}, children = []</span>) {
  <span class="hljs-keyword">const</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(name)

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(attrs)) {
    element[key] = value
  }

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> child <span class="hljs-keyword">of</span> children) {
    element.<span class="hljs-title function_">appendChild</span>(child)
  }

  <span class="hljs-keyword">return</span> element
}
</code></pre>
<p>Then I have a more specific helper that empties both the results and
message <code>div</code>s. This is useful because when show results, I also want to
clear an eventual previous error message, and when showing an error, I
want to clear an eventual previous results set.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">emptyFormData</span> (<span class="hljs-params">form</span>) {
  form.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.posts&#x27;</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;&#x27;</span>
  form.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.message&#x27;</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;&#x27;</span>
}
</code></pre>
<p>This is followed by another quick helper to set the message.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">formMessage</span> (<span class="hljs-params">form, textContent</span>) {
  <span class="hljs-title function_">emptyFormData</span>(form)
  form.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.message&#x27;</span>).<span class="hljs-title function_">appendChild</span>(<span class="hljs-title function_">el</span>(<span class="hljs-string">&#x27;p&#x27;</span>, { textContent }))
}
</code></pre>
<p>Now, to the interesting parts.</p>
<h3 id="the-submit-part" tabindex="-1"><a class="header-anchor" href="#the-submit-part"><span>The submit part</span></a></h3>
<p>The <code>onSearchSubmit</code> function needs to be defined globally to be
callable from the HTML.</p>
<p>ESLint doesn‚Äôt like this, and thinks the function is unused (it can‚Äôt
guess it‚Äôs being called from the HTML), so I need to add the comment
above to ignore this warning.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// eslint-disable-next-line no-unused-vars</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">onSearchSubmit</span> (<span class="hljs-params">form</span>) {
  <span class="hljs-title function_">searchBlog</span>(form)
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err)
      <span class="hljs-title function_">formMessage</span>(form, <span class="hljs-string">&#x27;An error occurred! Check the console. ü§≠&#x27;</span>)
    })

  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
}
</code></pre>
<p>It then calls the <code>searchBlog</code> asynchronous function, handles any error
by logging it and showing a message using the <code>formMessage</code> helper.</p>
<p>Finally it returns <code>false</code> to prevent the default behavior of the form
submission, which is to submit the form data as query parameters on the
current URL.</p>
<p>The following is the breakdown of the <code>searchBlog</code> function, defined as:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">searchBlog</span> (<span class="hljs-params">form</span>) {
  <span class="hljs-comment">// Code goes here.</span>
}
</code></pre>
<h3 id="the-search-part" tabindex="-1"><a class="header-anchor" href="#the-search-part"><span>The search part</span></a></h3>
<p>We start with a quick sanity check.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> query = form.<span class="hljs-property">query</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">toLowerCase</span>()

<span class="hljs-keyword">if</span> (!query.<span class="hljs-property">length</span>) {
  <span class="hljs-keyword">return</span>
}
</code></pre>
<p>The GitHub repo for my blog is public, and the GitHub API can be called
anonymously, without any kind of token, OAuth or other authentication
mechanism.</p>
<p>This makes the search trivial to implement:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> q = <span class="hljs-string">`<span class="hljs-subst">${query}</span> in:file language:markdown repo:valeriangalliat/blog`</span>

<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`https://api.github.com/search/code?q=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(q)}</span>`</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>())
</code></pre>
<p>In practice, I also need to fetch the <code>posts.html</code> page which contains
the links to all the posts on the blog. This will allow me to find the
title of the pages that are matched without loading every single page.
In the end the code looks like this:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> [result, posts] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`https://api.github.com/search/code?q=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(q)}</span>`</span>)
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>()),
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/posts.html&#x27;</span>)
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">text</span>())
])
</code></pre>
<h3 id="the-render-part" tabindex="-1"><a class="header-anchor" href="#the-render-part"><span>The render part</span></a></h3>
<p>First, I remove <code>index.md</code> and <code>posts.md</code> from the results, since those
pages include a lot of links to existing articles, they would be matched
very often, and are not usually relevant.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> items = result.<span class="hljs-property">items</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ![<span class="hljs-string">&#x27;index.md&#x27;</span>, <span class="hljs-string">&#x27;posts.md&#x27;</span>].<span class="hljs-title function_">includes</span>(item.<span class="hljs-property">path</span>))
</code></pre>
<p>Then, I add a quick check in case there was no match, again using the
<code>formMessage</code> helper.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">if</span> (!items.<span class="hljs-property">length</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">formMessage</span>(form, <span class="hljs-string">&#x27;No matches found on the blog. ü•∫&#x27;</span>)
}
</code></pre>
<p>Then I create a (native) <code>DOMParser</code> to parse the posts page, which
allows me to <code>querySelector</code> the matched posts by <code>href</code>.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMParser</span>()
<span class="hljs-keyword">const</span> postsDocument = parser.<span class="hljs-title function_">parseFromString</span>(posts, <span class="hljs-string">&#x27;text/html&#x27;</span>)

<span class="hljs-keyword">const</span> lis = items.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> url = item.<span class="hljs-property">path</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\.md$/</span>, <span class="hljs-string">&#x27;.html&#x27;</span>)
  <span class="hljs-keyword">return</span> postsDocument.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">`a[href=&quot;<span class="hljs-subst">${url}</span>&quot;]`</span>).<span class="hljs-property">parentNode</span>
})
</code></pre>
<p>In practice though, this page links posts relatively (e.g.
<code>2021/07/post-title.md</code>), while the search form could be included
anywhere, and require an absolute link like <code>/2021/07/post-title.md</code>. To
support this, we need to slightly modify the code:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> lis = items.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> relativeUrl = item.<span class="hljs-property">path</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\.md$/</span>, <span class="hljs-string">&#x27;.html&#x27;</span>)
  <span class="hljs-keyword">const</span> url = <span class="hljs-string">`/<span class="hljs-subst">${relativeUrl}</span>`</span>
  <span class="hljs-keyword">const</span> a = postsDocument.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">`a[href=&quot;<span class="hljs-subst">${relativeUrl}</span>&quot;]`</span>)

  a.<span class="hljs-property">href</span> = url

  <span class="hljs-keyword">return</span> a.<span class="hljs-property">parentNode</span>
})
</code></pre>
<p>I also want to sort the results by most recent post. The date is
included in a <code>&lt;small&gt;</code> element whose content is compatible with
<code>Date.parse</code> so this is convenient:</p>
<pre><code class="hljs language-js">lis.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">parse</span>(b.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;small&#x27;</span>).<span class="hljs-property">textContent</span>) - <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">parse</span>(a.<span class="hljs-title function_">querySelecotr</span>(<span class="hljs-string">&#x27;small&#x27;</span>).<span class="hljs-property">textContent</span>))
</code></pre>
<p>Finally I can show the results.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> ul = <span class="hljs-title function_">el</span>(<span class="hljs-string">&#x27;ul&#x27;</span>, {}, lis)

<span class="hljs-title function_">emptyFormData</span>(form)
form.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.posts&#x27;</span>).<span class="hljs-title function_">appendChild</span>(ul)
</code></pre>
<h3 id="the-reality-is-a-bit-more-complex-just-a-bit" tabindex="-1"><a class="header-anchor" href="#the-reality-is-a-bit-more-complex-just-a-bit"><span>The reality is a bit more complex (just a bit)</span></a></h3>
<p>This whole search feature is implemented in around 50 lines of code, HTML and
JS combined, including helpers. And this is awesome.</p>
<p>In reality, I want to search not only blog posts, but also pages. Pages
don‚Äôt have a date for me to sort with, and are not listed in
<code>posts.html</code> so I can‚Äôt find their title instantly. Also <a href="../../2019/03/macos-high-sierra-msi-h110m-pro-d-skylake-nvidia-pascal.html">some of my titles</a>
include a <code>&lt;small&gt;</code> element, so it‚Äôs something to take into account.</p>
<p>In <a href="https://github.com/valeriangalliat/blog/blob/01ded0c8defe399526032030bf17b912be6b6319/js/main.js#L163">the real code</a>, I have to do a couple more things for
this to work.</p>
<ol>
<li>Check if a matching <code>&lt;a&gt;</code> is found in the <code>postsDocument</code>,
otherwise fetch the page itself and extract the <code>&lt;h1&gt;</code> as title.</li>
<li>Take into account that pages don‚Äôt have a date when sorting, for
example by using <code>Date.parse(b.querySelector('small').textContent) || 0</code>,
so that we don‚Äôt try to subtract <code>NaN</code> which would mess up the
sorting.</li>
</ol>
<p>For the latter, I decided to add a <code>customSortValue</code> property to the
<code>li</code> element instead, so that I can easily pass data from the loop to
the sorting function. Not exactly clean, but so convenient.</p>
<p>This allows me to run <code>Date.parse</code> only once per result instead of
running it at every iteration of the <code>sort</code> function, and removes the
need to use the <code>&lt;small&gt;</code> element content for sorting, as it‚Äôs not
always valid.</p>
<p>I also replaced <code>li.querySelector('small')</code> by <code>li.lastElementChild</code> to
support posts that include a <code>&lt;small&gt;</code> element in the title.</p>
<p>Here‚Äôs the full code:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> lis = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(items.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">async</span> item =&gt; {
  <span class="hljs-keyword">const</span> relativeUrl = item.<span class="hljs-property">path</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\.md$/</span>, <span class="hljs-string">&#x27;.html&#x27;</span>)
  <span class="hljs-keyword">const</span> url = <span class="hljs-string">`/<span class="hljs-subst">${relativeUrl}</span>`</span>
  <span class="hljs-keyword">const</span> a = postsDocument.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">`a[href=&quot;<span class="hljs-subst">${relativeUrl}</span>&quot;]`</span>)

  <span class="hljs-keyword">if</span> (a) {
    <span class="hljs-keyword">const</span> li = a.<span class="hljs-property">parentNode</span>
    a.<span class="hljs-property">href</span> = url
    <span class="hljs-keyword">const</span> small = li.<span class="hljs-property">lastElementChild</span>
    li.<span class="hljs-property">customSortValue</span> = small ? <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">parse</span>(small.<span class="hljs-property">textContent</span>) : <span class="hljs-number">0</span>
    <span class="hljs-keyword">return</span> li
  }

  <span class="hljs-comment">// Fall back to fetching `&lt;h1&gt;` from actual page.</span>
  <span class="hljs-keyword">const</span> html = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">text</span>())
  <span class="hljs-keyword">const</span> pageDocument = parser.<span class="hljs-title function_">parseFromString</span>(html, <span class="hljs-string">&#x27;text/html&#x27;</span>)

  <span class="hljs-keyword">return</span> <span class="hljs-title function_">el</span>(<span class="hljs-string">&#x27;li&#x27;</span>, { <span class="hljs-attr">customSortValue</span>: <span class="hljs-number">0</span> }, [
    <span class="hljs-title function_">el</span>(<span class="hljs-string">&#x27;a&#x27;</span>, {
      <span class="hljs-attr">href</span>: url,
      <span class="hljs-attr">textContent</span>: pageDocument.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;h1&#x27;</span>).<span class="hljs-property">textContent</span>
    }),
    <span class="hljs-title function_">el</span>(<span class="hljs-string">&#x27;small&#x27;</span>, {
      <span class="hljs-attr">textContent</span>: <span class="hljs-string">&#x27;‚Äî&#x27;</span>
    })
  ])
}))

lis.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b.<span class="hljs-property">customSortValue</span> - a.<span class="hljs-property">customSortValue</span>)
</code></pre>
<p>This block starts to be a bit long and could probably be refactored into
different functions, but since it‚Äôs not code that I foresee evolving a
lot, I‚Äôm fine with it like this.</p>
<h2 id="wrapping-up" tabindex="-1"><a class="header-anchor" href="#wrapping-up"><span>Wrapping up</span></a></h2>
<p>I hope you find this feature useful on the blog, or this code useful for
you to implement a similar feature on your own site.</p>
<p>This tweet popped in my timeline yesterday, and couldn‚Äôt relate more. I
think it illustrates perfectly the search implementation on this blog.</p>
<blockquote>
<figure>
  <a href="https://twitter.com/flaviocopes/status/1417007331930423298/photo/1">
    <img alt="Code complexity" srcset="../../img/2021/07/code-complexity.jpg 3x">
  </a>
</figure>
<p>‚Äî <a href="https://twitter.com/flaviocopes">@flaviocopes</a>, <a href="https://twitter.com/flaviocopes/status/1417007331930423298">July 19, 2021</a></p>
</blockquote>
<p>After more than 10 years building websites, I‚Äôve had my fare share of
frameworks, design patterns, bleeding edge libraries, compiling and
transpiling everything possible and new cool, revolutionary ways of
doing one thing or another.</p>
<p>While those kept me excited for many years, I ended up getting bored of
it, and incidentally started writing <a href="../../simple.html">boring code</a>.</p>
<p>They‚Äôre all tools after all, and I won‚Äôt use them unless I have a good
reason to.</p>
<p>Have a great day, and keep things simple! üôè</p>
<section class="post-footer">
  <h3>Want to leave a comment?</h3>
  <p>
    Join the discussion on <a href="https://twitter.com/valeriangalliat/status/1417551014987767812">Twitter</a> or send me an <a href="mailto:val@codejam.info">email</a>! üíå<br>
    This post helped you? <a href="https://ko-fi.com/funkyval">Buy me a coffee</a>! üçª
  </p>
</section>
  </div>
  <footer>
    <div class="footer-inner">
      <figure>
        <a href="/val.html">
          <img alt="The author (Val) in front of a mountain" src="/img/profile.jpg">
        </a>
      </figure>
      <div class="footer-content">
        <p>
          Made with üß° by <a href="/val.html">Val</a>.
          Generated from a <abbr title="Pull requests welcome!"><a href="https://github.com/valeriangalliat/blog/tree/master/2021/07/search-static-blog-github-api.md">public repository</a></abbr>.
        </p>
        <ul class="social">
          <li>
            <a href="https://twitter.com/valeriangalliat">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>Twitter</title>
                <use href="/img/icons/407-twitter.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://github.com/valeriangalliat">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>GitHub</title>
                <use href="/img/icons/433-github.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://www.instagram.com/funkyval_/">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>Instagram</title>
                <use href="/img/icons/403-instagram.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://www.youtube.com/@FunkyVal">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>YouTube</title>
                <use href="/img/icons/414-youtube.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="https://ko-fi.com/funkyval">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>Buy me a coffee!</title>
                <use href="/img/icons/219-heart.svg#icon"></use>
              </svg>
            </a>
          </li>
          <li>
            <a href="/feed.xml">
              <svg width="16" height="16" viewBox="0 0 16 16">
                <title>RSS</title>
                <use href="/img/icons/412-rss.svg#icon"></use>
              </svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </footer>
  <script src="/js/emojicon.js"></script>
  <script src="/js/main-20230317.js"></script>
</body>
</html>
